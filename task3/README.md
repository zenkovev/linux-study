# Комментарии к заданию

## Код и демонстрация

Патчем с изменениями является файл `patch.txt`. В данном случае, кажется, это даже не должно
повлиять, но порядок изменения кода ядра такой: сначала патч `awesome_modules/patch_syscall.txt`
на основе семинара по написанию системного вызова, затем патч для текущего задания. Демонстрация
находится в файле `demonstration.mp4`.

## Реализация

В задании нужно было вносить изменения в код ядра, отвечающего за создание процессов и потоков,
для этого нужно понимать, а где из кучи файлов находится тот код, который нужно править, я
пытался даже читать книгу _Роберт Лав. Ядро Linux. Описание процесса разработки_, оставлю здесь
[ссылку](https://itsecforu.ru/wp-content/uploads/2018/01/1lav_robert_yadro_linux_opisanie_protsessa_razrabotki.pdf),
но по итогу всё равно пришёл к тому, чтобы спрашивать нейронки, где находится тот или иной код.

Исходный код ядра, отвечающий за работу с процессами и потоками:
- `linux-6.7.4/include/linux/sched.h`: структура `task_struct` с информацией о процессе или потоке
- `linux-6.7.4/kernel/fork.c`: функция `copy_process` для создания нового процесса
- `linux-6.7.4/kernel/sched/core.c`: функция `schedule` для планирования процессов и потоков
- `linux-6.7.4/fs/proc/base.c`: создание файлов для файловой системы `/proc`

Создание файла `schedcount` делал по аналогии с файлом `schedstat`, так как логично,
что они работают примерно одинаково.

При тестовых запусках выяснилось, что содержимое файла `schedcount` совпало с третьим полем
файла `schedstat`. В этом третьем поле выводится следующая информация:
```c
struct task_struct *task;
task->sched_info.pcount;
// # of times we have run on this CPU
```

В целом, логично, что эти значения часто совпадают.